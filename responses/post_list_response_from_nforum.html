<script type="text/javascript">
if (!document.getElementById('body')) {
    var redir = window.location.href.replace('/nForum/', '/nForum/#!');
    window.location.href = redir;
}
</script>
<style type="text/css">
.t-btn a {
    display: inline-block;
    text-align: center;
    font-size: 14px;
    margin-right: 4px;
    padding: 2px 6px;
    padding: 3px 6px 1px\9
}

.t-btn a:hover {
    color: #FFF
}

.t-btn .input {
    color: #999;
    font-size: 12px;
    margin-right: 5px
}

.t-btn .rss {
    padding: 0;
    vertical-align: bottom
}

.t-btn label {
    margin-right: 5px;
    margin-left: 2px;
    vertical-align: middle
}

.page {
    float: right;
    padding-top: 2px;
    *padding-top: 0
}

.t-pre,
.t-pre-bottom {
    margin-top: 2px;
    width: 100%
}

.t-pre-bottom .t-btn {
    margin-left: 5px
}

.b-head div {
    cursor: pointer
}

.b-content {
    padding: 1px 0;
    border: 0 none;
    margin-top: 0
}

#quick_reply {
    width: 100%;
    margin-top: 4px;
    background: #f3f5fc
}

#quick_reply td {}

textarea {
    width: 99.5%;
    height: 70px;
    border: 1px solid #6688ee;
    font-size: 12px
}

#quick_submit {
    width: 70px;
    vertical-align: middle
}

#quick_submit .button {
    height: 65px;
    width: 65px;
    margin: 3px;
    cursor: pointer
}

#recommend {
    visibility: hidden
}

#sogou_banner {
    text-align: center
}

.likes {
    margin: 20px 50px 50px 50px;
    background-color: #f0f0f0;
    border: 1px solid #333333;
    padding: 10px
}

.like_name {
    font-size: 14px;
    font-weight: bold;
    padding: 5px
}

.like_list {
    padding: 5px
}

.like_score_1 {
    color: red
}

.like_score_2 {
    color: green
}

.like_score_0 {}

.like_user {
    padding-left: 5px;
    font-weight: bold
}

.like_msg {
    padding-left: 5px;
    color: #333333
}

.like_time {
    padding-left: 8px;
    color: #999999
}

#midadv_slider {
    float: center;
    height: 90px;
    margin: 5px 0 5px 0
}

#midadv_slider li {
    display: none
}

#midadv_slider li.cur {
    display: block
}
</style>
<div class="t-pre">
    <div class="page">
        <ul class="pagination">
            <li class="page-pre">贴数:<i>2</i>&emsp;分页:</li>
            <li>
                <ol title="分页列表" class="page-main">
                    <li class="page-select"><a title="当前页">1</a></li>
                </ol>
            </li>
            <li class="page-suf"></li>
        </ul>
    </div>
    <div class="t-btn"><a href="/nForum/article/Test/post" class="a-post button">新话题</a><a href="/nForum/article/Test/tmpl" class="a-post button">模版发文</a><a href="javascript:void(0)" id="a_reply" class="button">快捷回复</a><a href="javascript:void(0)" class="button add_like">评价/Like</a></div>
</div>
<div class="b-head corner"><span class="n-right"><span style="color:#eee;vertical-align:bottom" id="a_share" _u="http://www.newsmth.net/nForum/article/Test/910406" _c="[测试]测试图文混排的结果">分享到:</span></span><span class="n-left">文章主题:&ensp;[测试]测试图文混排的结果</span></div>
<div class="b-content corner">
    <a name="a0"></a>
    <div class="a-wrap corner">
        <table class="article">
            <tr class="a-head">
                <td class="a-left"><span class="a-u-name"><a href="/nForum/user/query/mozilla">mozilla</a></span><span class="a-u-sex"><samp title="性别保密哦 在线" class="ico-pos-online-hide" ></samp></span></td>
                <td>
                    <ul class="a-func">
                        <li>
                            <samp class="ico-pos-reply"></samp><a href="/nForum/article/Test/post/910406" class="a-post">回复</a></li>
                        <li>
                            <samp class="ico-pos-template"></samp><a href="/nForum/article/Test/tmpl?id=910406" class="a-post">模版回复</a></li>
                        <li>
                            <samp class="ico-pos-forward"></samp><a href="/nForum/article/Test/ajax_forward/910406.json" class="a-func-forward">转寄</a></li>
                        <li>
                            <samp class="ico-pos-search"></samp><a href="/nForum/s/article?b=Test&au=mozilla">搜索</a></li>
                        <li>
                            <samp class="ico-pos-user"></samp><a href="/nForum/article/Test/910406?au=mozilla">只看此ID</a></li>
                    </ul><span class="a-pos">楼主</span></td>
            </tr>
            <tr class="a-body">
                <td class="a-left">
                    <div class="a-u-img"><img src="http://images.newsmth.net/nForum/uploadFace/M/mozilla.7812.jpg" width="120px" height="120px" /></div>
                    <div class="a-u-uid">Delivery Done!</div>
                    <dl class="a-u-info">
                        <dt>身份</dt>
                        <dd>用户</dd>
                        <dt>文章</dt>
                        <dd>7779</dd>
                        <dt>积分</dt>
                        <dd>69980</dd>
                        <dt>等级</dt>
                        <dd>楠木(12)</dd>
                    </dl>
                </td>
                <td class="a-content">
                    <p>发信人: mozilla (Delivery Done!), 信区: Test
                        <br /> 标&nbsp;&nbsp;题: [测试]测试图文混排的结果
                        <br /> 发信站: 水木社区 (Fri Mar 18 20:52:50 2016), 站内
                        <br />&nbsp;&nbsp;
                        <br /> 在 RxJava 的默认规则中，事件的发出和消费都是在同一个线程的。也就是说，如果只用上面的方法，实现出来的只是一个同步的观察者模式。观察者模式本身的目的就是『后台处理，前台回调』的异步机制，因此异步对于 RxJava 是至关重要的。而要实现异步，则需要用到 RxJava 的另一个概念： Scheduler 。
                        <br />&nbsp;&nbsp;
                        <br /> 3. 线程控制 —— Scheduler (一)
                        <br />&nbsp;&nbsp;
                        <br /> 在不指定线程的情况下， RxJava 遵循的是线程不变的原则，即：在哪个线程调用 subscribe()，就在哪个线程生产事件；在哪个线程生产事件，就在哪个线程消费事件。如果需要切换线程，就需要用到 Scheduler （调度器）。
                        <br />&nbsp;&nbsp;
                        <br /> 1) Scheduler 的 API (一)
                        <br />&nbsp;&nbsp;
                        <br /> 在RxJava 中，Scheduler ——调度器，相当于线程控制器，RxJava 通过它来指定每一段代码应该运行在什么样的线程。RxJava 已经内置了几个 Scheduler ，它们已经适合大多数的使用场景：
                        <br />
                        <br />
                        <a target="_blank" href="http://att.newsmth.net/nForum/att/Test/910406/2323"><img border="0" title="单击此查看原图" src="http://att.newsmth.net/nForum/att/Test/910406/2323/large" class="resizeable" /></a>
                        <br />&nbsp;&nbsp;
                        <br /> Schedulers.immediate(): 直接在当前线程运行，相当于不指定线程。这是默认的 Scheduler。
                        <br /> Schedulers.newThread(): 总是启用新线程，并在新线程执行操作。
                        <br /> Schedulers.io(): I/O 操作（读写文件、读写数据库、网络信息交互等）所使用的 Scheduler。行为模式和 newThread() 差不多，区别在于 io() 的内部实现是是用一个无数量上限的线程池，可以重用空闲的线程，因此多数情况下 io() 比 newThread() 更有效率。不要把计算工作放在 io() 中，可以避免创建不必要的线程。
                        <br /> Schedulers.computation(): 计算所使用的 Scheduler。这个计算指的是 CPU 密集型计算，即不会被 I/O 等操作限制性能的操作，例如图形的计算。这个 Scheduler 使用的固定的线程池，大小为 CPU 核数。不要把 I/O 操作放在 computation() 中，否则 I/O 操作的等待时间会浪费 CPU。
                        <br /> 另外， Android 还有一个专用的 AndroidSchedulers.mainThread()，它指定的操作将在 Android 主线程运行。
                        <br /> 有了这几个 Scheduler ，就可以使用 subscribeOn() 和 observeOn() 两个方法来对线程进行控制了。
                        <br />&nbsp;&nbsp;
                        <br />
                        <br />
                        <a target="_blank" href="http://att.newsmth.net/nForum/att/Test/910406/235360"><img border="0" title="单击此查看原图" src="http://att.newsmth.net/nForum/att/Test/910406/235360/large" class="resizeable" /></a>
                        <br />&nbsp;&nbsp;
                        <br /> 上面这段代码中，由于 subscribeOn(Schedulers.io()) 的指定，被创建的事件的内容 1、2、3、4 将会在 IO 线程发出；而由于 observeOn(AndroidScheculers.mainThread()) 的指定，因此 subscriber 数字的打印将发生在主线程 。事实上，这种在 subscribe() 之前写上两句 subscribeOn(Scheduler.io()) 和 observeOn(AndroidSchedulers.mainThread()) 的使用方式非常常见，它适用于多数的 『后台线程取数据，主线程显示』的程序策略。
                        <br />&nbsp;&nbsp;
                        <br /> 而前面提到的由图片 id 取得图片并显示的例子，如果也加上这两句：
                        <br />&nbsp;&nbsp;
                        <br /> --
                        <br />&nbsp;&nbsp;
                        <br />
                        <font class="f000"></font>
                        <font class="f005">※ 来源:·水木社区 <a target="_blank" href="http://www.newsmth.net">http://www.newsmth.net</a>·[FROM: 104.224.134.*]</font>
                        <font class="f000">
                            <br />&nbsp;&nbsp;
                            <br /> </font>
                    </p>
                    <div class="t-pre-bottom t-btn" style="text-align:center;">
                        <button class="button add_like" style="width:180px;height:50px;font-size:18px;">我要Like！</button>
                    </div>
                    <div id="like_util" _b="Test" _a="910406" style="display:none" />
                </td>
            </tr>
            <tr class="a-bottom">
                <td class="a-left">
                    <ul class="a-func a-func-info">
                        <li>
                            <samp class="ico-pos-query"></samp><a href="/nForum/user/query/mozilla">查看</a></li>
                        <li>
                            <samp class="ico-pos-mess"></samp><a href="/nForum/mail/Test/reply/910406?id=mozilla" class="a-post">发信</a></li>
                        <li>
                            <samp class="ico-pos-friend"></samp><a href="/nForum/friend/ajax_add.json?id=mozilla" class="a-func-friend a-post">加好友</a></li>
                    </ul>
                </td>
                <td><a href="#" class="c63f a-back">返回顶部</a></td>
            </tr>
        </table>
    </div>
    <div id="sogou_banner">
        <div id="midadv_slider">
            <ul class="midadv_show">
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/#!board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-06-29-16-02-44.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/#!board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-07-01-17-47-40.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/#!board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-07-01-17-48-51.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.jiaju100.com/" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-08-04-17-32-13.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/#!board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-08-04-17-23-11.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-09-08-13-37-09.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-09-18-13-51-30.png" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-09-25-14-58-42.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/#!board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2015-12-17-15-11-03.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/#!board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2016-01-03-17-57-31.jpg" /></a>
                </li>
                <li class="">
                    <a style="display:block" href="http://www.newsmth.net/nForum/board/Occupier" target="_blank"><img src="http://images.newsmth.net/nForum/files/adv/2016-01-31-17-53-37.jpg" /></a>
                </li>
            </ul>
        </div>
    </div>
    <div id="dt_bfd_box"></div>
    <a name="a1"></a>
    <div class="a-wrap corner">
        <table class="article">
            <tr class="a-head">
                <td class="a-left"><span class="a-u-name"><a href="/nForum/user/query/zSMTHDev">zSMTHDev</a></span><span class="a-u-sex"><samp title="男生哦 在线" class="ico-pos-online-man" ></samp></span></td>
                <td>
                    <ul class="a-func">
                        <li>
                            <samp class="ico-pos-reply"></samp><a href="/nForum/article/Test/post/910571" class="a-post">回复</a></li>
                        <li>
                            <samp class="ico-pos-forward"></samp><a href="/nForum/article/Test/ajax_forward/910571.json" class="a-func-forward">转寄</a></li>
                        <li>
                            <samp class="ico-pos-search"></samp><a href="/nForum/s/article?b=Test&au=zSMTHDev">搜索</a></li>
                        <li>
                            <samp class="ico-pos-user"></samp><a href="/nForum/article/Test/910406?au=zSMTHDev">只看此ID</a></li>
                        <li>
                            <samp class="ico-pos-edit"></samp><a href="/nForum/article/Test/edit/910571">编辑</a></li>
                        <li>
                            <samp class="ico-pos-del"></samp><a href="/nForum/article/Test/ajax_delete/910571.json" class="a-func-del">删除</a></li>
                    </ul><span class="a-pos">第1楼</span></td>
            </tr>
            <tr class="a-body">
                <td class="a-left">
                    <div class="a-u-img"><img src="http://images.newsmth.net/nForum/uploadFace/Z/zSMTHDev.2452.jpg" width="120px" height="120px" /></div>
                    <div class="a-u-uid">zSMTHDev</div>
                    <dl class="a-u-info">
                        <dt>身份</dt>
                        <dd>用户</dd>
                        <dt>文章</dt>
                        <dd>4</dd>
                        <dt>星座</dt>
                        <dd>白羊座</dd>
                        <dt>积分</dt>
                        <dd>849</dd>
                        <dt>管理积分</dt>
                        <dd>0</dd>
                        <dt>等级</dt>
                        <dd>白杨(6)</dd>
                    </dl>
                </td>
                <td class="a-content">
                    <p>发信人: zSMTHDev (zSMTHDev), 信区: Test
                        <br /> 标&nbsp;&nbsp;题: Re: [测试]测试图文混排的结果
                        <br /> 发信站: 水木社区 (Wed Mar 30 00:29:32 2016), 站内
                        <br />&nbsp;&nbsp;
                        <br /> 这个结果很不错啊
                        <br />&nbsp;&nbsp;
                        <br /> --
                        <br />&nbsp;&nbsp;
                        <br />
                        <font class="f000"></font>
                        <font class="f003">※ 来源:·水木社区 <a target="_blank" href="http://www.newsmth.net">http://www.newsmth.net</a>·[FROM: 114.240.87.*]</font>
                        <font class="f000">
                            <br /> </font>
                    </p>
                </td>
            </tr>
            <tr class="a-bottom">
                <td class="a-left">
                    <ul class="a-func a-func-info">
                        <li>
                            <samp class="ico-pos-query"></samp><a href="/nForum/user/query/zSMTHDev">查看</a></li>
                        <li>
                            <samp class="ico-pos-mess"></samp><a href="/nForum/mail/Test/reply/910571?id=zSMTHDev" class="a-post">发信</a></li>
                        <li>
                            <samp class="ico-pos-friend"></samp><a href="/nForum/friend/ajax_add.json?id=zSMTHDev" class="a-func-friend a-post">加好友</a></li>
                    </ul>
                </td>
                <td><a href="#" class="c63f a-back">返回顶部</a></td>
            </tr>
        </table>
    </div>
    <div id="dt_bfd_box"></div>
</div>
<div style="text-align:center">
    <iframe src="/nForum/baiduunion/article_down" frameborder="0" width="750" height="110" scrolling="no"></iframe>
</div>
<div class="t-pre-bottom">
    <div class="page">
        <ul class="pagination">
            <li class="page-pre">文章数:<i>2</i>&emsp;分页:</li>
            <li>
                <ol title="分页列表" class="page-main">
                    <li class="page-select"><a title="当前页">1</a></li>
                </ol>
            </li>
            <li class="page-suf"></li>
        </ul>
    </div>
    <div class="t-btn">
        <form id="f_search" method="get" action="/nForum/s/article">
            <input type="text" class="input-text input" name="t1" placeholder="输入关键字" size="16" />
            <input type="text" class="input-text input" name="au" placeholder="输入作者ID" size="12" />
            <input type="checkbox" name="m" id="c_m" />
            <label for="c_m">精华帖</label>
            <input type="checkbox" name="a" id="c_a" />
            <label for="c_a">带附件</label>
            <input type="submit" class="button" value="搜索" />&emsp;&emsp;
            <input type="button" class="button" value="超级搜索" onclick="window.open('http://ar.newsmth.net/search.jsp?boardname=Test')" />
            <input type="hidden" name="b" value="Test" />
        </form>
    </div>
</div>
<form id="quick_post" method="post" action="/nForum/article/Test/ajax_post.json">
    <table id="quick_reply" class="corner">
        <tr>
            <td>
                <textarea id="quick_text" name="content"></textarea>
            </td>
            <td id="quick_submit">
                <input type="submit" class="button" value="快捷回复" />
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <div id="em_img"></div>
            </td>
        </tr>
    </table>
    <input type="hidden" name="id" value="910406" />
    <input type="hidden" name="subject" value="Re%3A%20%5B%E6%B5%8B%E8%AF%95%5D%E6%B5%8B%E8%AF%95%E5%9B%BE%E6%96%87%E6%B7%B7%E6%8E%92%E7%9A%84%E7%BB%93%E6%9E%9C" />
</form>
<script id="tmpl_forward" type="text/template">
    <form id="a_forward" action="<%=action%>" method="post">
        <ul>
            <li><span>收件人:</span>
                <input type="text" class="input-text" name="target" />
                <select id="a_forward_list">
                    <option value="">选择好友</option>
                    <%_.each(friends,function(f){%>
                        <option value="<%=f%>">
                            <%=f%>
                        </option>
                        <%});%>
                </select>
            </li>
            <li><span>合集转寄:</span>
                <input type="checkbox" name="threads" />&emsp;&emsp;<span class="noref" style="display:none">不带引文:</span>
                <input class="noref" type="checkbox" name="noref" style="display:none" />
            </li>
            <li><span>不含附件:</span>
                <input type="checkbox" name="noatt" />
            </li>
            <li class="internet" style="display:none"><span>转为BIG5:</span>
                <input type="checkbox" name="big5" />&emsp;&emsp;<span>过滤ANSI:</span>
                <input type="checkbox" name="noansi checked=" checked " /></li></form></script><script id="tmpl_add_like " type="text/template "><form id="form_add_like " action="<%=action%>" method="post">
                <section class="list-block">
                    <header>我要Like</header>
                    <ul class="narrow">
                        <li><span>说明：</span><a href="http://www.newsmth.net/bbsanc.php?path=%2Fgroups%2Fsystem.faq%2FProgress%2Flike" target="_blank">评分不为0时需扣除一定用户积分，若文章被系统收录，将成倍奖励返还。点击查看说明</a></li>
                        <li><span>积分：</span>
                            <table class="board-list tiz" cellpadding="0" cellspacing="0">
                                <thead>
                                    <tr>
                                        <th>评分</th>
                                        <th>花费积分</th>
                                        <th>若被收录奖励积分</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>-5</td>
                                        <td>25</td>
                                        <td>50</td>
                                    </tr>
                                    <tr>
                                        <td>-4</td>
                                        <td>16</td>
                                        <td>32</td>
                                    </tr>
                                    <tr>
                                        <td>-3</td>
                                        <td>9</td>
                                        <td>18</td>
                                    </tr>
                                    <tr>
                                        <td>-2</td>
                                        <td>4</td>
                                        <td>8</td>
                                    </tr>
                                    <tr>
                                        <td>-1</td>
                                        <td>1</td>
                                        <td>2</td>
                                    </tr>
                                    <tr>
                                        <td>0</td>
                                        <td>0</td>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>1</td>
                                        <td>2</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>4</td>
                                        <td>8</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>9</td>
                                        <td>18</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>16</td>
                                        <td>32</td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>25</td>
                                        <td>50</td>
                                    </tr>
                                </tbody>
                            </table>
                        </li>
                        <li><span>评分：</span>
                            <select name="score">
                                <option value="-5">-5</option>
                                <option value="-4">-4</option>
                                <option value="-3">-3</option>
                                <option value="-2">-2</option>
                                <option value="-1">-1</option>
                                <option value="0" selected>0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </li>
                        <li><span>短评：</span>
                            <input type="text" size="70" name="msg" maxlength="30" placeholder="请输入您的短评，不超过30个字" />
                        </li>
                        <li><span>标签：</span>
                            <input type="text" size="70" name="tag" maxlength="30" placeholder="请输入分类标签，不超过30个字" />
                        </li>
                    </ul>
                </section>
    </form>
</script>
<script type="text/javascript">
window["_BFD"] = window["_BFD"] || {};
_BFD.BFD_INFO = {
    "page_type": "detail"
};
</script>
<script type="text/javascript">
$('#notice_nav').html('<a href="/nForum/mainpage">水木社区</a>&ensp;>>&ensp;<a href="/nForum/section/0">社区管理</a>&ensp;>>&ensp;<a href="/nForum/board/Test">测试专用版面</a>&ensp;>>&ensp;<a href="javascript:void(0)">阅读文章</a>');
$.setTitle('[测试]测试图文混排的结果');;
</script>
<script type="text/javascript">
;
var BShare = {
    sites: [{
        "title": "分享到新浪微博",
        "url": "http://service.weibo.com/share/share.php?url=%url%&title=%content%&pic=&appkey=57541378&ralateUid=2149648625",
        "img": 'http://www.sinaimg.cn/blog/developer/wiki/16x16.png'
    }, {
        "title": "分享到腾讯微博",
        "url": "http://v.t.qq.com/share/share.php?url=%url%&title=%content%&appkey=185c1394b1bc4fdd905cdf3ca861b366&site=http://www.newsmth.net",
        "img": 'http://v.t.qq.com/share/images/s/weiboicon16.png'
    }, {
        "title": "分享到豆瓣",
        "url": "http://www.douban.com/recommend/?url=%url%&title=%content%",
        "img": 'http://img2.douban.com/pics/fw2douban_s.png'
    }],
    template: '<img style="margin-left:5px;cursor:pointer;vertical-align:bottom;width:16px;height:16px;" title="%title%" src="%img%" />',
    init: function(area, url, content) {
        $(this.sites).each(function(i, e) {
            var template = BShare.template;
            e.url = e.url.replace(/%url%/g, encodeURIComponent(url));
            e.url = e.url.replace(/%content%/g, encodeURIComponent(content));
            template = template.replace(/%img%/g, e.img);
            template = template.replace(/%title%/g, e.title);
            $(template).bind('click', e.url, BShare.handler).appendTo(area)
        })
    },
    handler: function(e) {
        var f = function() {
            if (!window.open(e.data, '_blank', 'toolbar=0,resizable=1,scrollbars=yes,status=1,width=640,height=480')) location.href = e.data
        };
        if (/Firefox/.test(navigator.userAgent)) setTimeout(f, 0);
        else f()
    }
};
$(function() {
    $('#quick_text').ubb({
        enable: false,
        ubb_img_path: SYS.base + "/img/ubb/",
        ubb_em: $('#em_img')
    });
    var validPost = function() {
        if (!SESSION.get('is_login')) {
            $('#u_login_id').alertDialog(SYS.code.MSG_LOGIN);
            return false
        }
        return true
    };
    $('#quick_post').submit(function() {
        if ($.trim($('#quick_text').val()) == '') {
            $('#quick_text').alertDialog(SYS.code.MSG_NULL);
            return false
        }
        if (validPost()) {
            $.post($('#quick_post').attr('action'), $('#quick_post').getPostData(), function(json) {
                DIALOG.ajaxDialog(json)
            }, 'json')
        }
        return false
    });
    $('#f_search').submit(function() {
        BODY.open($(this).attr('action') + '?' + _.map($(this).getPostData(), function(v, k) {
            v = encodeURIComponent(encodeURIComponent(v));
            return k + '=' + v
        }).join('&'));
        return false
    });
    $('#f_search input[placeholder]').placeholder();
    $('#body').on('click', '.a-post', validPost).on('click', '#a_reply', function() {
        validPost();
        $('#quick_text').focus()
    }).on('click', '.a-func-friend', function() {
        $.post($(this).attr('href'), function(json) {
            delete json['default'];
            delete json['list'];
            DIALOG.ajaxDialog(json)
        }, 'json');
        return false
    }).on('keydown', '#quick_text', function(event) {
        if (event.ctrlKey && event.keyCode == 13) {
            $('#quick_post').submit();
            return false
        }
    }).on('click', '.a-func-del', function() {
        var self = this;
        DIALOG.confirmDialog('确认删除此文章?', function() {
            $.post($(self).attr('href'), function(json) {
                DIALOG.ajaxDialog(json)
            }, 'json')
        });
        return false
    }).on('click', '.a-back', function() {
        $('html,body').animate({
            scrollTop: 0
        }, 500)
    });
    BShare.init($('#a_share').parent(), $('#a_share').attr('_u'), $('#a_share').attr('_c'));
    if ($('.map-map').length > 0) nForumMap.loadJs('nForumMap.parseMap', null);
    var friends = SYS.cache('friends');
    $('#body').on('click', '.a-func-forward', function() {
        if (!SESSION.get('is_login')) {
            $('#u_login_id').alertDialog(SYS.code.MSG_LOGIN);
            return false
        }
        var d = DIALOG.formDialog(_.template($('#tmpl_forward').html())({
            action: $(this).attr('href'),
            friends: friends || []
        }), {
            buttons: [{
                text: SYS.code.COM_SUBMIT,
                click: function() {
                    var f = $(this).find('#a_forward');
                    $.post(f.attr('action'), f.getPostData(), function(repo) {
                        DIALOG.ajaxDialog(repo)
                    });
                    $(this).dialog('close')
                }
            }, {
                text: SYS.code.COM_CANCAL,
                click: function() {
                    $(this).dialog('close')
                }
            }]
        }).on('change', 'select', function() {
            $(this).prev().val($(this).val()).change()
        }).on('change', 'input[name="target"]', function() {
            if (/@/.test($(this).val())) {
                d.find('.internet').show()
            } else {
                d.find('.internet').hide()
            }
        }).on('change', 'input[name="threads"]', function() {
            if ($(this).prop('checked')) {
                d.find('.noref').show()
            } else {
                d.find('.noref').hide()
            }
        });
        if (!friends) {
            $.getJSON(SYS.ajax.friend_list, function(json) {
                if (!_.isArray(json)) return;
                d.find('#a_forward_list').append(_.reduce(json, function(ret, item) {
                    ret += ('<option value="' + item + '">' + item + '</option>');
                    return ret
                }, ''));
                SYS.cache('friends', json)
            })
        }
        return false
    });
    $('#body').on('click', '.a-func-docross', function() {
        if (!SESSION.get('is_login')) {
            $('#u_login_id').alertDialog(SYS.code.MSG_LOGIN);
            return false
        }
        var d = DIALOG.formDialog(_.template($('#tmpl_docross').html())({
            action: $(this).attr('href')
        }), {
            buttons: [{
                text: SYS.code.COM_SUBMIT,
                click: function() {
                    var f = $(this).find('#a_docross');
                    $.post(f.attr('action'), f.getPostData(), function(repo) {
                        DIALOG.ajaxDialog(repo)
                    });
                    $(this).dialog('close')
                }
            }, {
                text: SYS.code.COM_CANCAL,
                click: function() {
                    $(this).dialog('close')
                }
            }]
        });
        return false
    });
    if (typeof sh_init !== 'undefined') sh_init();
    $('#body').on('click', '#recommend', function() {
        var href = $(this).attr('href');
        $.get(href, function(data) {
            if (!data.ajax_st) {
                DIALOG.alertDialog(data.ajax_msg)
            } else {
                DIALOG.confirmDialog("本站只接受推荐优秀原创内容，请勿推荐无关帖。确认推荐?", function() {
                    $.get(href + '?do', function(data) {
                        if (!data.ajax_st) {
                            DIALOG.alertDialog(data.ajax_msg)
                        } else {
                            DIALOG.alertDialog('推荐成功!')
                        }
                    })
                })
            }
        });
        return false
    });
    $('#recommend').css('visibility', 'visible');
    $('#authimg').click(function() {
        this.src = $(this).attr('_src') + "?_t=" + $.random()
    }).click();
    if ($('#like_util').attr('_b') != undefined && $('#like_util').attr('_a') != undefined) {
        var lb = $('#like_util').attr('_b');
        var la = $('#like_util').attr('_a');
        $('.add_like').click(function() {
            var data = {
                action: SYS.base + '/article/' + lb + '/ajax_add_like/' + la + '.json'
            };
            var d = DIALOG.formDialog(_.template($('#tmpl_add_like').html())(data), {
                width: 600,
                buttons: [{
                    text: SYS.code.COM_SUBMIT,
                    click: function() {
                        var f = $(this).find('#form_add_like');
                        $.post(f.attr('action'), f.getPostData(), function(repo) {
                            DIALOG.ajaxDialog(repo)
                        });
                        $(this).dialog('close')
                    }
                }, {
                    text: SYS.code.COM_CANCAL,
                    click: function() {
                        $(this).dialog('close')
                    }
                }]
            });
            return false
        })
    }
    var midadv_defaultOpts = {
        interval: 4000,
        fadeInTime: 300,
        fadeOutTime: 200
    };
    var _midadv_bodies = $("#midadv_slider .midadv_show li");
    _midadv_bodies.eq(0).addClass("cur");
    var _midadv_count = _midadv_bodies.length;
    var _midadv_current = 0;
    var _midadv_intervalID = null;
    var midadv_stop = function() {
        window.clearInterval(_midadv_intervalID)
    };
    var midadv_slide = function() {
        _midadv_current = (_midadv_current >= (_midadv_count - 1)) ? 0 : (++_midadv_current);
        _midadv_bodies.filter(":visible").fadeOut(midadv_defaultOpts.fadeOutTime, function() {
            _midadv_bodies.eq(_midadv_current).fadeIn(midadv_defaultOpts.fadeInTime);
            _midadv_bodies.removeClass("cur").eq(_midadv_current).addClass("cur")
        })
    };
    var midadv_go = function() {
        midadv_stop();
        if (_midadv_count > 1) _midadv_intervalID = window.setInterval(function() {
            midadv_slide()
        }, midadv_defaultOpts.interval)
    };
    _midadv_bodies.hover(midadv_stop, midadv_go);
    midadv_go()
});
</script>
